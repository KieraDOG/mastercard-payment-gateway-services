{"version":3,"sources":["App.js","serviceWorker.js","index.js"],"names":["MASTER_CARD_SESSION_JS_SRC","onScriptLoad","initialized","formSessionUpdate","PaymentSession","window","configure","fields","card","number","securityCode","expiryMonth","expiryYear","nameOnCard","frameEmbeddingMitigation","callbacks","response","console","log","pay","updateSessionFromForm","loadScript","a","document","Promise","reject","resolve","prevScript","querySelector","remove","script","createElement","src","async","onload","body","appendChild","Wrapper","styled","Box","Payment","onFormSessionUpdated","useState","initializing","setInitializing","handleFormSessionUpdate","useCallback","status","session","id","sourceOfFunds","provided","scheme","errors","cardNumber","message","useEffect","then","width","Flex","position","top","right","bottom","left","bg","alignItems","LoadingIndicator","my","Input","type","mb","title","aria-label","readOnly","Button","variant","onClick","App","toggle","setToggle","p","alert","prevToggle","Boolean","location","hostname","match","ReactDOM","render","ThemeProvider","theme","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.a70818ec.chunk.js","sourcesContent":["import React, { useEffect, useState , useCallback} from 'react';\nimport { Box, Button, Input, Flex, LoadingIndicator } from 'roo-ui/components';\nimport styled from '@emotion/styled';\n\nconst MASTER_CARD_SESSION_JS_SRC = 'https://test-gateway.mastercard.com/form/version/52/merchant/TESTJSTAY01/session.js';\n\nconst onScriptLoad = ({\n  initialized,\n  formSessionUpdate,\n}) => {\n  const { PaymentSession } = window;\n\n  if (!PaymentSession) {\n    return;\n  }\n\n  PaymentSession.configure({\n    fields: {\n      card: {\n        number: \"#card-number\",\n        securityCode: \"#security-code\",\n        expiryMonth: \"#expiry-month\",\n        expiryYear: \"#expiry-year\",\n        nameOnCard: \"#cardholder-name\",\n      },\n    },\n    frameEmbeddingMitigation: [\"javascript\"],\n    callbacks: {\n      initialized: (response) => {\n        console.log('Session initialized', response);\n        initialized(response);\n      },\n      formSessionUpdate: (response) => {\n        console.log('Form session update', response);\n        formSessionUpdate(response);\n      },\n    },\n  });\n};\n\nfunction pay() {\n  const { PaymentSession } = window;\n\n  if (!PaymentSession) {\n    return;\n  }\n\n  PaymentSession.updateSessionFromForm('card');\n}\n\nconst loadScript = async (formSessionUpdate) => {\n  if (!document) {\n    return Promise.reject();\n  }\n\n  return new Promise((resolve) => {\n    const prevScript = document.querySelector(`script[src=\"${MASTER_CARD_SESSION_JS_SRC}\"]`);\n\n    if (prevScript) {\n      prevScript.remove();\n    }\n  \n    const script = document.createElement('script');\n    script.src = MASTER_CARD_SESSION_JS_SRC;\n    script.async = 1;\n    script.onload = () => onScriptLoad({\n      initialized: resolve,\n      formSessionUpdate,\n    });\n  \n    document.body.appendChild(script);\n  }); \n}\n\nconst Wrapper = styled(Box)`\n  iframe {\n    display: block;\n  }\n`;\n\nconst Payment = ({\n  onFormSessionUpdated,\n}) => {\n  const [initializing, setInitializing] = useState(true);\n\n  const handleFormSessionUpdate = useCallback((response) => {\n    // HANDLE RESPONSE FOR UPDATE SESSION\n    if (response.status) {\n      if (\"ok\" === response.status) {\n        console.log(\"Session updated with data: \" + response.session.id);\n        onFormSessionUpdated(response.session.id);\n\n        //check if the security code was provided by the user\n        if (response.sourceOfFunds.provided.card.securityCode) {\n          console.log(\"Security code was provided.\");\n        }\n\n        //check if the user entered a Mastercard credit card\n        if (response.sourceOfFunds.provided.card.scheme === 'MASTERCARD') {\n          console.log(\"The user entered a Mastercard credit card.\")\n        }\n      } else if (\"fields_in_error\" === response.status)  {\n        console.log(\"Session update failed with field errors.\");\n        if (response.errors.cardNumber) {\n          console.log(\"Card number invalid or missing.\");\n        }\n        if (response.errors.expiryYear) {\n          console.log(\"Expiry year invalid or missing.\");\n        }\n        if (response.errors.expiryMonth) {\n          console.log(\"Expiry month invalid or missing.\");\n        }\n        if (response.errors.securityCode) {\n          console.log(\"Security code invalid.\");\n        }\n      } else if (\"request_timeout\" === response.status)  {\n        console.log(\"Session update failed with request timeout: \" + response.errors.message);\n      } else if (\"system_error\" === response.status)  {\n        console.log(\"Session update failed with system error: \" + response.errors.message);\n      }\n    } else {\n      console.log(\"Session update failed: \" + response);\n    }\n  }, [onFormSessionUpdated])\n\n  useEffect(() => {\n    loadScript(handleFormSessionUpdate).then(() => setInitializing(false));\n  }, [handleFormSessionUpdate]);\n\n  return (\n    <Wrapper width=\"300px\">\n      {initializing && (\n        <Flex position=\"absolute\" top=\"0\" right=\"0\" bottom=\"0\" left=\"0\" bg=\"rgba(0, 0, 0, 0.1)\" alignItems=\"center\">\n          <LoadingIndicator />\n        </Flex>\n      )} \n      <Box my=\"2\">Please enter your payment details:</Box>\n      <h3>Credit Card</h3>\n      <Box my=\"2\">\n        Card Number: \n        <Input type=\"text\" mb=\"0\" id=\"card-number\" title=\"card number\" aria-label=\"enter your card number\" readOnly />\n      </Box>\n      <Box my=\"2\">\n        Expiry Month:\n        <Input type=\"text\" mb=\"0\" id=\"expiry-month\" title=\"expiry month\" aria-label=\"two digit expiry month\" readOnly />\n      </Box>\n      <Box my=\"2\">\n        Expiry Year:\n        <Input type=\"text\" mb=\"0\" id=\"expiry-year\" title=\"expiry year\" aria-label=\"two digit expiry year\" readOnly />\n      </Box>\n      <Box my=\"2\">\n        Security Code:\n        <Input type=\"text\" mb=\"0\" id=\"security-code\" title=\"security code\" aria-label=\"three digit CCV security code\" readOnly />\n      </Box>\n      <Box my=\"2\">\n        Cardholder Name:\n        <Input type=\"text\" mb=\"0\" id=\"cardholder-name\" title=\"cardholder name\" aria-label=\"enter name on card\" readOnly />\n      </Box>\n      <Box my=\"2\">\n        <Button variant=\"primary\" onClick={pay}>\n          Pay Now\n        </Button>\n      </Box>\n    </Wrapper>\n  );\n}\n\nconst App = () => {\n  const [toggle, setToggle] = useState(false);\n  \n  return (\n    <Box p=\"4\">\n      {toggle && (<Payment onFormSessionUpdated={alert} />)}\n      <Button onClick={() => setToggle(prevToggle => !prevToggle)}>Toggle</Button>\n    </Box>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'roo-ui/fonts/ciutadella.css';\nimport { ThemeProvider, theme } from 'roo-ui';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render((\n  <ThemeProvider theme={theme}>\n    <App />\n  </ThemeProvider>\n), document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}